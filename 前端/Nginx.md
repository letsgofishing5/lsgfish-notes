### 配置文件的三个组成部分

##### 全局块

从配置文件开始，到 events 块之间的内容，主要会设置一些影响 nginx 服务器整体运行的配置指令

比如：worker_processes。worker_processes 值越大，可以支持的并发处理量也越多

##### events块

`events`块涉及的指令主要影响`Nginx`服务器与用户的网络连接

比如`worker_ connections 1024;` 支持的最大连接数~

##### http块

Nginx服务器配置中最频繁的部分

http 块也可以包括 http 全局块，server 块

### 配置文件

#### 反向代理

##### location指令

```bash
location [ = | ~ | ~* | ^~ ] url { 

}
=：用于不含正则表达式的路径匹配
~：用于表示url包含正则表达式，并且区分大小写
~*：用于表示url包含正则表达式，并且不区分大小写
^~：用于表示不含正则表达式的url前，要求 Nginx 服务器找到标识 url 和请求字符串匹配度最高的location 后，立即使用此location 处理求，而不再使用location块中的正则uri 和请求字符串做匹配。。
```

#### 负载均衡

1. 轮询（默认）

   > 每个请求按时间顺序逐一分配到不 同的后端服务器，如果后端服务器down掉，能自动剔除。。

2. weight

   > weight代表权,重默认为1,权重越高被分配的客户端越多。
   > 指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。

3. ip_hash

   > 每个请求按访问ip的hash结果分配，这样每个访客固定访问一-个后端服务器，可以解决session的问题。

4. fair

   > 按后端服务器的响应时间来分配请求，响应时间短的优先分配。。